<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Symulator Finansowy - Lekcja Technikum</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f6; margin: 20px; color: #333; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #2c3e50; }
        .mode-selector { display: flex; justify-content: center; gap: 20px; margin-bottom: 30px; }
        .mode-btn { padding: 12px 30px; font-size: 1em; border: 2px solid #3498db; background: white; color: #3498db; border-radius: 8px; cursor: pointer; font-weight: bold; transition: all 0.3s; }
        .mode-btn.active { background: #3498db; color: white; }
        .mode-btn:hover { transform: scale(1.05); }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .input-section { background: #eef2f3; padding: 20px; border-radius: 8px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input { width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        .results { padding: 20px; border: 1px solid #ddd; border-radius: 8px; background: #fff; }
        .results.hidden { display: none; }
        .result-item { margin-bottom: 10px; font-size: 1.1em; }
        .highlight { font-weight: bold; color: #e67e22; }
        .chart-container { margin-top: 30px; height: 400px; }
        footer { margin-top: 20px; text-align: center; font-size: 0.9em; color: #7f8c8d; }
    </style>
</head>
<body>

<div class="container">
    <h1>üìä Symulator: Stopy Procentowe i Inflacja</h1>
    
    <div class="mode-selector">
        <button class="mode-btn active" onclick="setMode('savings')">üí∞ Lokata</button>
        <button class="mode-btn" onclick="setMode('loan')">üè† Kredyt</button>
    </div>
    
    <div class="grid">
        <div class="input-section">
            <label>Kwota poczƒÖtkowa (PLN):</label>
            <input type="number" id="capital" value="10000" oninput="updateAll()">

            <label>Roczna stopa procentowa (%):</label>
            <input type="number" id="rate" value="7" step="0.1" oninput="updateAll()">

            <label>Okres (lata):</label>
            <input type="number" id="years" value="10" oninput="updateAll()">

            <label>Przewidywana inflacja (%):</label>
            <input type="number" id="inflation" value="5" step="0.1" oninput="updateAll()">
        </div>

        <div id="loan-results" class="results hidden">
            <h3>üè† Kredyt (Raty r√≥wne)</h3>
            <div class="result-item">Miesiƒôczna rata: <span id="monthly-payment" class="highlight">-</span></div>
            <div class="result-item">Suma odsetek dla banku: <span id="total-interest" class="highlight">-</span></div>
            <div class="result-item">Ca≈Çkowita kwota do sp≈Çacenia: <span id="total-paid" class="highlight">-</span></div>
        </div>
        
        <div id="savings-results" class="results">
            <h3>üí∞ Lokata (Oszczƒôdzanie)</h3>
            <div class="result-item">Kwota po <span id="y-label">10</span> latach: <span id="final-nominal" class="highlight">-</span></div>
            <div class="result-item">Realna si≈Ça nabywcza: <span id="final-real" style="color: #27ae60; font-weight: bold;">-</span></div>
            <p style="font-size: 0.8em; color: #7f8c8d;">*Uwzglƒôdniono podatek Belki 19%</p>
        </div>
    </div>

    <div class="chart-container">
        <canvas id="myChart"></canvas>
    </div>

    <footer>
        Narzƒôdzie dydaktyczne dla uczni√≥w technikum | Przygotowane z pomocƒÖ Gemini
    </footer>
</div>

<script>
let myChart;
let currentMode = 'savings';

function setMode(mode) {
    currentMode = mode;
    
    // Zmiana aktywnego przycisku
    document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    // Pokazanie/ukrycie sekcji wynik√≥w
    document.getElementById('loan-results').classList.toggle('hidden', mode !== 'loan');
    document.getElementById('savings-results').classList.toggle('hidden', mode !== 'savings');
    
    // Aktualizacja wykresu
    updateAll();
}

function calculateLoan(P, annualRate, years) {
    let r = annualRate / 100 / 12;
    let n = years * 12;
    if (r === 0) return P / n;
    return P * (r * Math.pow(1 + r, n)) / (Math.pow(1 + r, n) - 1);
}

function updateAll() {
    const P = parseFloat(document.getElementById('capital').value);
    const r = parseFloat(document.getElementById('rate').value);
    const t = parseInt(document.getElementById('years').value);
    const infl = parseFloat(document.getElementById('inflation').value);
    const belka = 0.19;

    // KREDYT
    const monthly = calculateLoan(P, r, t);
    const totalPaid = monthly * t * 12;
    document.getElementById('monthly-payment').innerText = monthly.toFixed(2) + " z≈Ç";
    document.getElementById('total-interest').innerText = (totalPaid - P).toFixed(2) + " z≈Ç";
    document.getElementById('total-paid').innerText = totalPaid.toFixed(2) + " z≈Ç";
    document.getElementById('y-label').innerText = t;

    // DANE DO WYKRESU (OSZCZƒòDNO≈öCI)
    let labels = [];
    let nominalData = [];
    let realData = [];

    let currentNominal = P;
    let currentReal = P;

    for (let i = 0; i <= t; i++) {
        labels.push("Rok " + i);
        
        // Obliczanie warto≈õci nominalnej po podatku Belki (rok po roku)
        if (i > 0) {
            let zyskRoczny = currentNominal * (r / 100);
            currentNominal += zyskRoczny * (1 - belka);
            currentReal = currentNominal / Math.pow(1 + (infl / 100), i);
        }

        nominalData.push(currentNominal.toFixed(2));
        realData.push(currentReal.toFixed(2));
    }

    document.getElementById('final-nominal').innerText = currentNominal.toFixed(2) + " z≈Ç";
    document.getElementById('final-real').innerText = currentReal.toFixed(2) + " z≈Ç";

    updateChart(labels, nominalData, realData);
}

function updateChart(labels, nominal, real) {
    const ctx = document.getElementById('myChart').getContext('2d');
    
    if (myChart) { myChart.destroy(); }

    let chartConfig = {};
    
    if (currentMode === 'savings') {
        chartConfig = {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Warto≈õƒá nominalna (na koncie)',
                    data: nominal,
                    backgroundColor: 'rgba(52, 152, 219, 0.8)',
                    borderColor: '#3498db',
                    borderWidth: 1
                }, {
                    label: 'Realna si≈Ça nabywcza (uwzgl. inflacjƒô)',
                    data: real,
                    backgroundColor: 'rgba(46, 204, 113, 0.8)',
                    borderColor: '#27ae60',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: { display: true, text: 'Lokata: Wzrost oszczƒôdno≈õci (nominalna vs realna warto≈õƒá)', fontSize: 14 },
                    legend: { display: true, position: 'top' }
                },
                scales: {
                    y: { beginAtZero: true, title: { display: true, text: 'Warto≈õƒá (PLN)' } }
                }
            }
        };
    } else {
        // Dla kredytu - pokazanie rozk≈Çadu rat
        let rataData = [];
        const P = parseFloat(document.getElementById('capital').value);
        const r = parseFloat(document.getElementById('rate').value);
        const t = parseInt(document.getElementById('years').value);
        const monthly = calculateLoan(P, r, t);
        
        for (let i = 0; i < labels.length; i++) {
            rataData.push(monthly * 12);
        }
        
        chartConfig = {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Roczne raty do sp≈Çacenia',
                    data: rataData,
                    backgroundColor: 'rgba(231, 76, 60, 0.8)',
                    borderColor: '#e74c3c',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: { display: true, text: 'Kredyt: Harmonogram rocznych rat', fontSize: 14 },
                    legend: { display: true, position: 'top' }
                },
                scales: {
                    y: { beginAtZero: true, title: { display: true, text: 'Warto≈õƒá (PLN)' } }
                }
            }
        };
    }
    
    myChart = new Chart(ctx, chartConfig);
}

updateAll();
</script>
</body>
</html>
